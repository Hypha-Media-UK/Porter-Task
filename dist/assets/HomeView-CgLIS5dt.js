import{a as W,r as w,c as h,g as X,b as o,f as k,h as Z,x as a,e as t,t as r,n as j,y as tt,z as P,A as T,F as f,B as b,i as st,C as A,D as et,E as ot,o as i}from"./vendor-DszYqHt7.js";import{u as it,a as nt,f as M,b as lt,_ as at}from"./index-D51oTREZ.js";import{T as rt}from"./TabNavigation-S16gUZfi.js";const dt={class:"home-view"},vt={key:0,class:"active-shift"},ut={class:"shift-card"},ct={class:"shift-header"},ht={class:"shift-title"},pt={class:"shift-supervisor"},gt={class:"supervisor-info"},ft={class:"supervisor-name"},bt={class:"shift-time"},wt={class:"time-details"},kt={class:"time-value"},mt={class:"shift-progress"},yt={class:"progress-label"},xt={class:"progress"},St={class:"shift-stats"},_t={class:"stat-item total"},Ct={class:"stat-value"},Pt={class:"stat-item pending"},Tt={class:"stat-value"},At={class:"stat-item completed"},$t={class:"stat-value"},Nt={class:"porters-section"},Vt={class:"porters-assignment"},Bt={class:"porter-selection"},Dt=["disabled"],Et=["value"],jt=["disabled"],Mt={key:0,class:"empty-porters"},Ht={key:1,class:"assigned-porters"},Ft={class:"porter-tags"},It={class:"porter-name"},Rt=["onClick"],zt={class:"shift-actions"},qt={key:0,class:"quick-actions-section"},Lt={class:"action-content"},Ut={class:"action-subtitle"},Ot={key:1,class:"new-shift"},Yt={key:0,class:"active-shift-notification"},Gt={class:"notification-actions"},Jt={class:"shift-form card"},Kt={class:"form-group"},Qt=["value"],Wt={class:"form-group porters-section"},Xt={class:"porters-assignment"},Zt={class:"porter-selection"},ts=["disabled"],ss=["value"],es=["disabled"],os={key:0,class:"empty-porters"},is={key:1,class:"assigned-porters"},ns={class:"porter-tags"},ls={class:"porter-name"},as=["onClick"],rs={class:"shift-actions"},ds=["disabled"],vs=["disabled"],us={key:1,class:"recent-shifts"},cs={class:"shift-list"},hs=["onClick"],ps={class:"shift-list-content"},gs={class:"shift-list-title"},fs={class:"shift-list-details"},bs={class:"shift-list-supervisor"},ws={class:"shift-list-tasks"},ks={class:"modal-content"},ms={class:"modal-actions"},ys=W({__name:"HomeView",setup(xs){const u=st("navigate"),H=it(),F=nt(),{isShiftActive:m,currentShift:l,archivedShifts:$,startShift:I,endShift:N,addPorterToShift:V,removePorterFromShift:R}=H,{supervisors:y,porters:x}=F,z=w("Day"),c=w(""),p=w(!1),d=w(""),v=w([]),q=h(()=>{if(!l.value)return"";const n=new Date(l.value.date);return`${M(n)}`}),S=h(()=>l.value?l.value.tasks.filter(n=>n.status==="Pending").length:0),_=h(()=>l.value?l.value.tasks.filter(n=>n.status==="Completed").length:0),B=h(()=>$.value?$.value.slice(0,3):[]),C=h(()=>!l.value||!l.value.assignedPorters?[]:l.value.assignedPorters),D=h(()=>x.filter(n=>!C.value.includes(n))),L=h(()=>x.filter(n=>!v.value.includes(n))),E=n=>{try{if(!c.value){console.error("No supervisor selected");return}if(console.log(`Starting ${n} shift with supervisor:`,c.value),m.value&&l.value){console.log("There is already an active shift. Ending current shift before starting a new one."),N(),window.location.reload();return}localStorage.removeItem("porter-track-current-shift");const s=I(n,c.value);console.log("New shift created:",s),v.value&&v.value.length>0&&(console.log(`Adding ${v.value.length} porters to shift:`,v.value),v.value.forEach(e=>{try{const g=V(e);console.log(`Added porter ${e}: ${g?"Success":"Failed"}`)}catch(g){console.error(`Error adding porter ${e}:`,g)}}),v.value=[]),console.log("Navigating to tasks view..."),window.location.href="/tasks"}catch(s){console.error("Critical error starting shift:",s),alert("Error starting shift: "+(s instanceof Error?s.message:String(s)))}},U=()=>{d.value&&!v.value.includes(d.value)?(console.log("Adding porter to initial list:",d.value),v.value.push(d.value),d.value=""):console.warn("Porter already in list or no porter selected")},O=n=>{const s=v.value.indexOf(n);s!==-1&&v.value.splice(s,1)},Y=()=>{N(),p.value=!1,u&&u("home")},G=n=>{u&&u("shiftDetail",{shiftId:n})},J=()=>{u&&u("archive")},K=()=>{d.value&&(V(d.value),d.value="")},Q=n=>{R(n)};return X(()=>{const n=new Date().getHours();z.value=n>=8&&n<20?"Day":"Night",y.length>0&&(c.value=y[0])}),(n,s)=>(i(),o("main",dt,[a(m)&&a(l)&&a(l).value?(i(),o("section",vt,[s[29]||(s[29]=t("header",{class:"top-header"},[t("h1",null,"Current Shift")],-1)),t("div",ut,[t("div",ct,[t("div",ht,[t("h2",null,r(q.value),1),t("div",{class:j(["shift-badge",a(l).value.type.toLowerCase()])},r(a(l).value.type),3)]),t("div",pt,[s[13]||(s[13]=t("div",{class:"supervisor-avatar"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t("circle",{cx:"12",cy:"7",r:"4"})])],-1)),t("div",gt,[s[12]||(s[12]=t("div",{class:"supervisor-label"},"Supervisor",-1)),t("div",ft,r(a(l).value.supervisor),1)])]),t("div",bt,[s[15]||(s[15]=t("div",{class:"time-icon"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})])],-1)),t("div",wt,[s[14]||(s[14]=t("div",{class:"time-label"},"Started",-1)),t("div",kt,r(a(lt)(new Date(a(l).value.startTime))),1)])])]),t("div",mt,[t("div",yt,[s[16]||(s[16]=t("span",null,"Task Completion",-1)),t("span",null,r(Math.round(_.value/(a(l).value.tasks.length||1)*100))+"%",1)]),t("div",xt,[t("div",{class:"progress-bar",style:tt({width:`${_.value/(a(l).value.tasks.length||1)*100}%`})},null,4)])]),t("div",St,[t("div",_t,[t("div",Ct,r(a(l).value.tasks.length),1),s[17]||(s[17]=t("div",{class:"stat-label"},"Total Tasks",-1))]),t("div",Pt,[t("div",Tt,r(S.value),1),s[18]||(s[18]=t("div",{class:"stat-label"},"Pending",-1))]),t("div",At,[t("div",$t,r(_.value),1),s[19]||(s[19]=t("div",{class:"stat-label"},"Completed",-1))])]),t("div",Nt,[s[23]||(s[23]=t("h3",null,"Porters Assignment",-1)),s[24]||(s[24]=t("p",{class:"section-description"},"Assign porters to this shift to manage task assignments",-1)),t("div",Vt,[t("div",Bt,[P(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),class:"form-control",disabled:!D.value.length},[s[20]||(s[20]=t("option",{value:"",disabled:""},"Select porter",-1)),(i(!0),o(f,null,b(D.value,e=>(i(),o("option",{key:e,value:e},r(e),9,Et))),128))],8,Dt),[[T,d.value]]),t("button",{class:"btn-primary",onClick:K,disabled:!d.value}," Add Porter ",8,jt)]),C.value.length===0?(i(),o("div",Mt,s[21]||(s[21]=[t("p",null,"No porters assigned to this shift yet.",-1)]))):(i(),o("div",Ht,[s[22]||(s[22]=t("h4",null,"Assigned Porters:",-1)),t("div",Ft,[(i(!0),o(f,null,b(C.value,e=>(i(),o("div",{key:e,class:"porter-tag"},[t("span",It,r(e),1),t("button",{class:"remove-porter",onClick:g=>Q(e),title:"Remove porter"}," × ",8,Rt)]))),128))])]))])]),t("div",zt,[t("button",{class:"btn-primary btn-large",onClick:s[1]||(s[1]=e=>a(u)("tasks"))}," View Tasks "),t("button",{class:"btn-danger btn-large",onClick:s[2]||(s[2]=e=>p.value=!0)}," End Shift ")])]),S.value>0?(i(),o("div",qt,[s[28]||(s[28]=t("h3",null,"Pending Tasks",-1)),t("div",{class:"quick-action-card",onClick:s[3]||(s[3]=e=>a(u)("pendingTasks"))},[s[26]||(s[26]=t("div",{class:"action-icon pending"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})])],-1)),t("div",Lt,[s[25]||(s[25]=t("div",{class:"action-title"},"View Pending Tasks",-1)),t("div",Ut,r(S.value)+" tasks waiting to be completed",1)]),s[27]||(s[27]=t("div",{class:"action-chevron"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))])])):k("",!0)])):(i(),o("section",Ot,[a(m)?(i(),o("div",Yt,[s[30]||(s[30]=A('<div class="notification-icon" data-v-38ba3eb9><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-38ba3eb9><circle cx="12" cy="12" r="10" data-v-38ba3eb9></circle><line x1="12" y1="8" x2="12" y2="12" data-v-38ba3eb9></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-38ba3eb9></line></svg></div><div class="notification-content" data-v-38ba3eb9><h3 data-v-38ba3eb9>Active Shift in Progress</h3><p data-v-38ba3eb9>There is currently an active shift. You need to end the current shift before starting a new one.</p></div>',2)),t("div",Gt,[t("button",{class:"btn-primary",onClick:s[4]||(s[4]=e=>a(u)("tasks"))}," Open Current Shift "),t("button",{class:"btn-danger",onClick:s[5]||(s[5]=e=>p.value=!0)}," End Current Shift ")])])):k("",!0),s[44]||(s[44]=A('<div class="welcome-card" data-v-38ba3eb9><div class="welcome-icon" data-v-38ba3eb9><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-38ba3eb9><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" data-v-38ba3eb9></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1" data-v-38ba3eb9></rect><path d="M9 14l2 2 4-4" data-v-38ba3eb9></path></svg></div><h2 data-v-38ba3eb9>Start a New Shift</h2><p data-v-38ba3eb9>Create a new porter shift to start tracking and managing tasks.</p></div>',1)),t("div",Jt,[t("div",Kt,[s[32]||(s[32]=t("label",{for:"supervisor"},"Supervisor",-1)),P(t("select",{id:"supervisor","onUpdate:modelValue":s[6]||(s[6]=e=>c.value=e),required:"",class:"form-control"},[s[31]||(s[31]=t("option",{value:"",disabled:""},"Select Supervisor",-1)),(i(!0),o(f,null,b(a(y),e=>(i(),o("option",{key:e,value:e},r(e),9,Qt))),128))],512),[[T,c.value]])]),t("div",Wt,[s[36]||(s[36]=t("label",null,"Porters Assignment",-1)),s[37]||(s[37]=t("p",{class:"section-description"},"Select porters who will be working during this shift",-1)),t("div",Xt,[t("div",Zt,[P(t("select",{"onUpdate:modelValue":s[7]||(s[7]=e=>d.value=e),class:"form-control",disabled:!L.value.length},[s[33]||(s[33]=t("option",{value:"",disabled:""},"Select porter",-1)),(i(!0),o(f,null,b(a(x),e=>(i(),o("option",{key:e,value:e},r(e),9,ss))),128))],8,ts),[[T,d.value]]),t("button",{class:"btn-primary",onClick:U,disabled:!d.value}," Add Porter ",8,es)]),v.value.length===0?(i(),o("div",os,s[34]||(s[34]=[t("p",null,"No porters assigned to this shift yet.",-1)]))):(i(),o("div",is,[s[35]||(s[35]=t("h4",null,"Assigned Porters:",-1)),t("div",ns,[(i(!0),o(f,null,b(v.value,e=>(i(),o("div",{key:e,class:"porter-tag"},[t("span",ls,r(e),1),t("button",{class:"remove-porter",onClick:g=>O(e),title:"Remove porter"}," × ",8,as)]))),128))])]))])]),t("div",rs,[t("button",{type:"button",class:"btn-primary btn-large",onClick:s[8]||(s[8]=e=>E("Day")),disabled:!c.value},s[38]||(s[38]=[A('<span class="btn-icon" data-v-38ba3eb9><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-38ba3eb9><circle cx="12" cy="12" r="5" data-v-38ba3eb9></circle><line x1="12" y1="1" x2="12" y2="3" data-v-38ba3eb9></line><line x1="12" y1="21" x2="12" y2="23" data-v-38ba3eb9></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-v-38ba3eb9></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-v-38ba3eb9></line><line x1="1" y1="12" x2="3" y2="12" data-v-38ba3eb9></line><line x1="21" y1="12" x2="23" y2="12" data-v-38ba3eb9></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-v-38ba3eb9></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-v-38ba3eb9></line></svg></span> Start Day Shift ',2)]),8,ds),t("button",{type:"button",class:"btn-secondary btn-large",onClick:s[9]||(s[9]=e=>E("Night")),disabled:!c.value},s[39]||(s[39]=[t("span",{class:"btn-icon"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})])],-1),et(" Start Night Shift ")]),8,vs)])]),B.value.length>0?(i(),o("div",us,[t("div",{class:"section-header"},[s[40]||(s[40]=t("h3",null,"Recent Shifts",-1)),t("button",{class:"view-all-link",onClick:J},"View All")]),t("div",cs,[(i(!0),o(f,null,b(B.value,e=>(i(),o("div",{key:e.id,class:"shift-list-item",onClick:g=>G(e.id)},[t("div",{class:j(["shift-list-icon",e.type.toLowerCase()])},s[41]||(s[41]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),t("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})],-1)]),2),t("div",ps,[t("div",gs,r(e.type)+" Shift - "+r(a(M)(new Date(e.date))),1),t("div",fs,[t("span",bs,r(e.supervisor),1),s[42]||(s[42]=t("span",{class:"separator"},"•",-1)),t("span",ws,r(e.tasks.length)+" tasks",1)])]),s[43]||(s[43]=t("div",{class:"shift-list-chevron"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))],8,hs))),128))])])):k("",!0)])),p.value?(i(),o("div",{key:2,class:"modal-backdrop",onClick:s[11]||(s[11]=ot(e=>p.value=!1,["self"]))},[t("div",ks,[s[45]||(s[45]=t("div",{class:"modal-handle"},null,-1)),s[46]||(s[46]=t("div",{class:"modal-header"},[t("h3",null,"End Shift?")],-1)),s[47]||(s[47]=t("div",{class:"modal-body"},[t("p",null,"Are you sure you want to end the current shift? This action cannot be undone.")],-1)),t("div",ms,[t("button",{class:"btn-secondary",onClick:s[10]||(s[10]=e=>p.value=!1)}," Cancel "),t("button",{class:"btn-danger",onClick:Y}," End Shift ")])])])):k("",!0),Z(rt,{"current-route":"home",onNavigate:a(u)},null,8,["onNavigate"])]))}}),Ps=at(ys,[["__scopeId","data-v-38ba3eb9"]]);export{Ps as default};
