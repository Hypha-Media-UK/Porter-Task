import{a as W,r as k,c as h,g as X,b as o,f as m,x as a,e as t,t as r,n as j,y as Z,z as P,A as T,F as f,B as w,i as tt,C as A,D as st,E as et,o as i}from"./vendor-DszYqHt7.js";import{u as ot,a as it,f as M,b as nt,_ as lt}from"./index-DlOD_Yz9.js";const at={class:"home-view"},rt={key:0,class:"active-shift"},dt={class:"shift-card"},vt={class:"shift-header"},ut={class:"shift-title"},ct={class:"shift-supervisor"},ht={class:"supervisor-info"},pt={class:"supervisor-name"},gt={class:"shift-time"},ft={class:"time-details"},wt={class:"time-value"},kt={class:"shift-progress"},mt={class:"progress-label"},yt={class:"progress"},bt={class:"shift-stats"},xt={class:"stat-item total"},St={class:"stat-value"},_t={class:"stat-item pending"},Ct={class:"stat-value"},Pt={class:"stat-item completed"},Tt={class:"stat-value"},At={class:"porters-section"},$t={class:"porters-assignment"},Bt={class:"porter-selection"},Dt=["disabled"],Vt=["value"],Nt=["disabled"],Et={key:0,class:"empty-porters"},jt={key:1,class:"assigned-porters"},Mt={class:"porter-tags"},Ht={class:"porter-name"},Ft=["onClick"],It={class:"shift-actions"},Rt={key:0,class:"quick-actions-section"},zt={class:"action-content"},qt={class:"action-subtitle"},Lt={key:1,class:"new-shift"},Ut={key:0,class:"active-shift-notification"},Ot={class:"notification-actions"},Yt={class:"shift-form card"},Gt={class:"form-group"},Jt=["value"],Kt={class:"form-group porters-section"},Qt={class:"porters-assignment"},Wt={class:"porter-selection"},Xt=["disabled"],Zt=["value"],ts=["disabled"],ss={key:0,class:"empty-porters"},es={key:1,class:"assigned-porters"},os={class:"porter-tags"},is={class:"porter-name"},ns=["onClick"],ls={class:"shift-actions"},as=["disabled"],rs=["disabled"],ds={key:1,class:"recent-shifts"},vs={class:"shift-list"},us=["onClick"],cs={class:"shift-list-content"},hs={class:"shift-list-title"},ps={class:"shift-list-details"},gs={class:"shift-list-supervisor"},fs={class:"shift-list-tasks"},ws={class:"modal-content"},ks={class:"modal-actions"},ms=W({__name:"HomeView",setup(ys){const u=tt("navigate"),H=ot(),F=it(),{isShiftActive:y,currentShift:l,archivedShifts:$,startShift:I,endShift:B,addPorterToShift:D,removePorterFromShift:R}=H,{supervisors:b,porters:x}=F,z=k("Day"),c=k(""),p=k(!1),d=k(""),v=k([]),q=h(()=>{if(!l.value)return"";const n=new Date(l.value.date);return`${M(n)}`}),S=h(()=>l.value?l.value.tasks.filter(n=>n.status==="Pending").length:0),_=h(()=>l.value?l.value.tasks.filter(n=>n.status==="Completed").length:0),V=h(()=>$.value?$.value.slice(0,3):[]),C=h(()=>!l.value||!l.value.assignedPorters?[]:l.value.assignedPorters),N=h(()=>x.filter(n=>!C.value.includes(n))),L=h(()=>x.filter(n=>!v.value.includes(n))),E=n=>{try{if(!c.value){console.error("No supervisor selected");return}if(console.log(`Starting ${n} shift with supervisor:`,c.value),y.value&&l.value){console.log("There is already an active shift. Ending current shift before starting a new one."),B(),window.location.reload();return}localStorage.removeItem("porter-track-current-shift");const s=I(n,c.value);console.log("New shift created:",s),v.value&&v.value.length>0&&(console.log(`Adding ${v.value.length} porters to shift:`,v.value),v.value.forEach(e=>{try{const g=D(e);console.log(`Added porter ${e}: ${g?"Success":"Failed"}`)}catch(g){console.error(`Error adding porter ${e}:`,g)}}),v.value=[]),console.log("Navigating to tasks view..."),window.location.href="/tasks"}catch(s){console.error("Critical error starting shift:",s),alert("Error starting shift: "+(s instanceof Error?s.message:String(s)))}},U=()=>{d.value&&!v.value.includes(d.value)?(console.log("Adding porter to initial list:",d.value),v.value.push(d.value),d.value=""):console.warn("Porter already in list or no porter selected")},O=n=>{const s=v.value.indexOf(n);s!==-1&&v.value.splice(s,1)},Y=()=>{B(),p.value=!1,u&&u("home")},G=n=>{u&&u("shiftDetail",{shiftId:n})},J=()=>{u&&u("archive")},K=()=>{d.value&&(D(d.value),d.value="")},Q=n=>{R(n)};return X(()=>{const n=new Date().getHours();z.value=n>=8&&n<20?"Day":"Night",b.length>0&&(c.value=b[0])}),(n,s)=>(i(),o("main",at,[a(y)&&a(l)&&a(l).value?(i(),o("section",rt,[s[29]||(s[29]=t("header",{class:"top-header"},[t("h1",null,"Current Shift")],-1)),t("div",dt,[t("div",vt,[t("div",ut,[t("h2",null,r(q.value),1),t("div",{class:j(["shift-badge",a(l).value.type.toLowerCase()])},r(a(l).value.type),3)]),t("div",ct,[s[13]||(s[13]=t("div",{class:"supervisor-avatar"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t("circle",{cx:"12",cy:"7",r:"4"})])],-1)),t("div",ht,[s[12]||(s[12]=t("div",{class:"supervisor-label"},"Supervisor",-1)),t("div",pt,r(a(l).value.supervisor),1)])]),t("div",gt,[s[15]||(s[15]=t("div",{class:"time-icon"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})])],-1)),t("div",ft,[s[14]||(s[14]=t("div",{class:"time-label"},"Started",-1)),t("div",wt,r(a(nt)(new Date(a(l).value.startTime))),1)])])]),t("div",kt,[t("div",mt,[s[16]||(s[16]=t("span",null,"Task Completion",-1)),t("span",null,r(Math.round(_.value/(a(l).value.tasks.length||1)*100))+"%",1)]),t("div",yt,[t("div",{class:"progress-bar",style:Z({width:`${_.value/(a(l).value.tasks.length||1)*100}%`})},null,4)])]),t("div",bt,[t("div",xt,[t("div",St,r(a(l).value.tasks.length),1),s[17]||(s[17]=t("div",{class:"stat-label"},"Total Tasks",-1))]),t("div",_t,[t("div",Ct,r(S.value),1),s[18]||(s[18]=t("div",{class:"stat-label"},"Pending",-1))]),t("div",Pt,[t("div",Tt,r(_.value),1),s[19]||(s[19]=t("div",{class:"stat-label"},"Completed",-1))])]),t("div",At,[s[23]||(s[23]=t("h3",null,"Porters Assignment",-1)),s[24]||(s[24]=t("p",{class:"section-description"},"Assign porters to this shift to manage task assignments",-1)),t("div",$t,[t("div",Bt,[P(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),class:"form-control",disabled:!N.value.length},[s[20]||(s[20]=t("option",{value:"",disabled:""},"Select porter",-1)),(i(!0),o(f,null,w(N.value,e=>(i(),o("option",{key:e,value:e},r(e),9,Vt))),128))],8,Dt),[[T,d.value]]),t("button",{class:"btn-primary",onClick:K,disabled:!d.value}," Add Porter ",8,Nt)]),C.value.length===0?(i(),o("div",Et,s[21]||(s[21]=[t("p",null,"No porters assigned to this shift yet.",-1)]))):(i(),o("div",jt,[s[22]||(s[22]=t("h4",null,"Assigned Porters:",-1)),t("div",Mt,[(i(!0),o(f,null,w(C.value,e=>(i(),o("div",{key:e,class:"porter-tag"},[t("span",Ht,r(e),1),t("button",{class:"remove-porter",onClick:g=>Q(e),title:"Remove porter"}," × ",8,Ft)]))),128))])]))])]),t("div",It,[t("button",{class:"btn-primary btn-large",onClick:s[1]||(s[1]=e=>a(u)("tasks"))}," View Tasks "),t("button",{class:"btn-danger btn-large",onClick:s[2]||(s[2]=e=>p.value=!0)}," End Shift ")])]),S.value>0?(i(),o("div",Rt,[s[28]||(s[28]=t("h3",null,"Pending Tasks",-1)),t("div",{class:"quick-action-card",onClick:s[3]||(s[3]=e=>a(u)("pendingTasks"))},[s[26]||(s[26]=t("div",{class:"action-icon pending"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})])],-1)),t("div",zt,[s[25]||(s[25]=t("div",{class:"action-title"},"View Pending Tasks",-1)),t("div",qt,r(S.value)+" tasks waiting to be completed",1)]),s[27]||(s[27]=t("div",{class:"action-chevron"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))])])):m("",!0)])):(i(),o("section",Lt,[a(y)?(i(),o("div",Ut,[s[30]||(s[30]=A('<div class="notification-icon" data-v-58a1418e><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-58a1418e><circle cx="12" cy="12" r="10" data-v-58a1418e></circle><line x1="12" y1="8" x2="12" y2="12" data-v-58a1418e></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-58a1418e></line></svg></div><div class="notification-content" data-v-58a1418e><h3 data-v-58a1418e>Active Shift in Progress</h3><p data-v-58a1418e>There is currently an active shift. You need to end the current shift before starting a new one.</p></div>',2)),t("div",Ot,[t("button",{class:"btn-primary",onClick:s[4]||(s[4]=e=>a(u)("tasks"))}," Open Current Shift "),t("button",{class:"btn-danger",onClick:s[5]||(s[5]=e=>p.value=!0)}," End Current Shift ")])])):m("",!0),s[44]||(s[44]=A('<div class="welcome-card" data-v-58a1418e><div class="welcome-icon" data-v-58a1418e><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-58a1418e><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" data-v-58a1418e></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1" data-v-58a1418e></rect><path d="M9 14l2 2 4-4" data-v-58a1418e></path></svg></div><h2 data-v-58a1418e>Start a New Shift</h2><p data-v-58a1418e>Create a new porter shift to start tracking and managing tasks.</p></div>',1)),t("div",Yt,[t("div",Gt,[s[32]||(s[32]=t("label",{for:"supervisor"},"Supervisor",-1)),P(t("select",{id:"supervisor","onUpdate:modelValue":s[6]||(s[6]=e=>c.value=e),required:"",class:"form-control"},[s[31]||(s[31]=t("option",{value:"",disabled:""},"Select Supervisor",-1)),(i(!0),o(f,null,w(a(b),e=>(i(),o("option",{key:e,value:e},r(e),9,Jt))),128))],512),[[T,c.value]])]),t("div",Kt,[s[36]||(s[36]=t("label",null,"Porters Assignment",-1)),s[37]||(s[37]=t("p",{class:"section-description"},"Select porters who will be working during this shift",-1)),t("div",Qt,[t("div",Wt,[P(t("select",{"onUpdate:modelValue":s[7]||(s[7]=e=>d.value=e),class:"form-control",disabled:!L.value.length},[s[33]||(s[33]=t("option",{value:"",disabled:""},"Select porter",-1)),(i(!0),o(f,null,w(a(x),e=>(i(),o("option",{key:e,value:e},r(e),9,Zt))),128))],8,Xt),[[T,d.value]]),t("button",{class:"btn-primary",onClick:U,disabled:!d.value}," Add Porter ",8,ts)]),v.value.length===0?(i(),o("div",ss,s[34]||(s[34]=[t("p",null,"No porters assigned to this shift yet.",-1)]))):(i(),o("div",es,[s[35]||(s[35]=t("h4",null,"Assigned Porters:",-1)),t("div",os,[(i(!0),o(f,null,w(v.value,e=>(i(),o("div",{key:e,class:"porter-tag"},[t("span",is,r(e),1),t("button",{class:"remove-porter",onClick:g=>O(e),title:"Remove porter"}," × ",8,ns)]))),128))])]))])]),t("div",ls,[t("button",{type:"button",class:"btn-primary btn-large",onClick:s[8]||(s[8]=e=>E("Day")),disabled:!c.value},s[38]||(s[38]=[A('<span class="btn-icon" data-v-58a1418e><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-58a1418e><circle cx="12" cy="12" r="5" data-v-58a1418e></circle><line x1="12" y1="1" x2="12" y2="3" data-v-58a1418e></line><line x1="12" y1="21" x2="12" y2="23" data-v-58a1418e></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-v-58a1418e></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-v-58a1418e></line><line x1="1" y1="12" x2="3" y2="12" data-v-58a1418e></line><line x1="21" y1="12" x2="23" y2="12" data-v-58a1418e></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-v-58a1418e></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-v-58a1418e></line></svg></span> Start Day Shift ',2)]),8,as),t("button",{type:"button",class:"btn-secondary btn-large",onClick:s[9]||(s[9]=e=>E("Night")),disabled:!c.value},s[39]||(s[39]=[t("span",{class:"btn-icon"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})])],-1),st(" Start Night Shift ")]),8,rs)])]),V.value.length>0?(i(),o("div",ds,[t("div",{class:"section-header"},[s[40]||(s[40]=t("h3",null,"Recent Shifts",-1)),t("button",{class:"view-all-link",onClick:J},"View All")]),t("div",vs,[(i(!0),o(f,null,w(V.value,e=>(i(),o("div",{key:e.id,class:"shift-list-item",onClick:g=>G(e.id)},[t("div",{class:j(["shift-list-icon",e.type.toLowerCase()])},s[41]||(s[41]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),t("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})],-1)]),2),t("div",cs,[t("div",hs,r(e.type)+" Shift - "+r(a(M)(new Date(e.date))),1),t("div",ps,[t("span",gs,r(e.supervisor),1),s[42]||(s[42]=t("span",{class:"separator"},"•",-1)),t("span",fs,r(e.tasks.length)+" tasks",1)])]),s[43]||(s[43]=t("div",{class:"shift-list-chevron"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})])],-1))],8,us))),128))])])):m("",!0)])),p.value?(i(),o("div",{key:2,class:"modal-backdrop",onClick:s[11]||(s[11]=et(e=>p.value=!1,["self"]))},[t("div",ws,[s[45]||(s[45]=t("div",{class:"modal-handle"},null,-1)),s[46]||(s[46]=t("div",{class:"modal-header"},[t("h3",null,"End Shift?")],-1)),s[47]||(s[47]=t("div",{class:"modal-body"},[t("p",null,"Are you sure you want to end the current shift? This action cannot be undone.")],-1)),t("div",ks,[t("button",{class:"btn-secondary",onClick:s[10]||(s[10]=e=>p.value=!1)}," Cancel "),t("button",{class:"btn-danger",onClick:Y}," End Shift ")])])])):m("",!0)]))}}),Ss=lt(ms,[["__scopeId","data-v-58a1418e"]]);export{Ss as default};
