import{u as j,f as m,b as f,c as A,_ as E}from"./index-D51oTREZ.js";import{T as V}from"./TabNavigation-S16gUZfi.js";import{a as $,r as h,c as p,g as F,w as P,b as l,h as M,x as d,e as t,C as z,t as i,n as v,F as R,B as H,i as O,o as r,f as q}from"./vendor-DszYqHt7.js";const G={class:"shift-detail-view"},J={key:0,class:"loading-state"},K={key:1,class:"empty-state"},Q={key:2,class:"shift-details"},U={class:"shift-card"},W={class:"shift-header"},X={class:"shift-date"},Y={class:"shift-info"},Z={class:"info-row"},tt={class:"info-item"},et={class:"value"},st={class:"info-item"},at={class:"value"},it={class:"info-item"},ot={class:"value"},nt={class:"info-item"},lt={class:"value"},rt={class:"stats-row"},dt={class:"stat-item"},ct={class:"stat-value"},ut={class:"stat-item"},vt={class:"stat-value"},ft={class:"stat-item"},mt={class:"stat-value"},ht={class:"tasks-section"},pt={class:"tasks-header"},_t={class:"tabs"},gt={key:0,class:"empty-tasks"},kt={key:1,class:"tasks-list"},Tt=["onClick"],wt={class:"task-info"},bt={class:"task-header"},yt={class:"task-type"},Ct={class:"task-time"},Dt={class:"task-journey"},St={class:"from-location"},xt={class:"to-location"},Nt={key:0,class:"task-completion"},It=$({__name:"ShiftDetailView",props:{shiftId:{}},setup(b){const c=b,u=O("navigate"),y=j(),{getShift:C,isLoading:D,deleteShift:S,reopenShift:x}=y;h(!1);const s=h(null),n=h("all"),_=async()=>{if(c.shiftId)try{const a=await C(c.shiftId);s.value=a||null}catch(a){console.error("Error loading shift details:",a),s.value=null}},g=p(()=>s.value?s.value.tasks.filter(a=>a.status==="Completed").length:0),k=p(()=>s.value?s.value.tasks.filter(a=>a.status==="Pending").length:0),T=p(()=>s.value?n.value==="all"?[...s.value.tasks].sort((a,e)=>new Date(e.receivedTime).getTime()-new Date(a.receivedTime).getTime()):n.value==="completed"?s.value.tasks.filter(a=>a.status==="Completed").sort((a,e)=>{const o=a.completedTime?new Date(a.completedTime).getTime():0;return(e.completedTime?new Date(e.completedTime).getTime():0)-o}):s.value.tasks.filter(a=>a.status==="Pending").sort((a,e)=>new Date(e.receivedTime).getTime()-new Date(a.receivedTime).getTime()):[]),w=()=>{u&&u("archive")},N=()=>{!s.value||!c.shiftId||confirm(`Are you sure you want to delete this shift from ${m(new Date(s.value.date))}?`)&&(S(c.shiftId),w())},I=()=>{if(!(!s.value||!c.shiftId))try{confirm(`Are you sure you want to reopen this shift from ${m(new Date(s.value.date))}?`)&&(x(c.shiftId),u&&u("home"))}catch(a){a instanceof Error?alert(a.message):alert("Could not reopen shift. Another shift might be active.")}},L=a=>{u&&u("taskForm",{taskId:a})};return F(_),P(()=>c.shiftId,_),(a,e)=>(r(),l("main",G,[d(D)?(r(),l("section",J,e[3]||(e[3]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading shift details...",-1)]))):s.value?(r(),l("section",Q,[t("article",U,[t("header",W,[t("div",X,i(d(m)(new Date(s.value.date))),1),t("div",{class:v(["shift-type",s.value.type.toLowerCase()])},i(s.value.type)+" Shift ",3)]),t("div",{class:"shift-actions"},[t("button",{class:"btn-primary btn-reopen-shift",onClick:I}," Reopen Shift "),t("button",{class:"btn-danger btn-delete-shift",onClick:N}," Delete Shift ")]),t("div",Y,[t("div",Z,[t("div",tt,[e[5]||(e[5]=t("span",{class:"label"},"Supervisor",-1)),t("span",et,i(s.value.supervisor),1)]),t("div",st,[e[6]||(e[6]=t("span",{class:"label"},"Start Time",-1)),t("span",at,i(d(f)(new Date(s.value.startTime))),1)]),t("div",it,[e[7]||(e[7]=t("span",{class:"label"},"End Time",-1)),t("span",ot,i(s.value.endTime?d(f)(new Date(s.value.endTime)):"Ongoing"),1)]),t("div",nt,[e[8]||(e[8]=t("span",{class:"label"},"Duration",-1)),t("span",lt,i(d(A)(s.value.startTime,s.value.endTime||"")),1)])])]),t("div",rt,[t("div",dt,[t("div",ct,i(s.value.tasks.length),1),e[9]||(e[9]=t("div",{class:"stat-label"},"Total Tasks",-1))]),t("div",ut,[t("div",vt,i(g.value),1),e[10]||(e[10]=t("div",{class:"stat-label"},"Completed",-1))]),t("div",ft,[t("div",mt,i(k.value),1),e[11]||(e[11]=t("div",{class:"stat-label"},"Pending",-1))])])]),t("section",ht,[t("header",pt,[e[12]||(e[12]=t("h2",null,"Tasks",-1)),t("nav",_t,[t("button",{class:v(["tab-btn",{active:n.value==="all"}]),onClick:e[0]||(e[0]=o=>n.value="all")}," All ("+i(s.value.tasks.length)+") ",3),t("button",{class:v(["tab-btn",{active:n.value==="completed"}]),onClick:e[1]||(e[1]=o=>n.value="completed")}," Completed ("+i(g.value)+") ",3),t("button",{class:v(["tab-btn",{active:n.value==="pending"}]),onClick:e[2]||(e[2]=o=>n.value="pending")}," Pending ("+i(k.value)+") ",3)])]),T.value.length===0?(r(),l("div",gt,[t("p",null,"No "+i(n.value==="all"?"":n.value)+" tasks for this shift.",1)])):(r(),l("ul",kt,[(r(!0),l(R,null,H(T.value,o=>(r(),l("li",{key:o.id,class:"task-item"},[t("article",{class:"shift-detail-task",onClick:B=>L(o.id)},[t("div",{class:v(["task-status",o.status.toLowerCase()])},null,2),t("div",wt,[t("div",bt,[t("div",yt,i(o.jobCategory)+" - "+i(o.itemType),1),t("div",Ct,i(d(f)(new Date(o.receivedTime))),1)]),t("div",Dt,[t("span",St,i(o.fromLocation.displayName),1),e[13]||(e[13]=t("span",{class:"journey-arrow"},"â†’",-1)),t("span",xt,i(o.toLocation.displayName),1)]),o.status==="Completed"&&o.completedTime?(r(),l("div",Nt," Completed: "+i(d(f)(new Date(o.completedTime))),1)):q("",!0)]),e[14]||(e[14]=t("button",{class:"edit-button","aria-label":"Edit task"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]),t("span",null,"Edit")],-1))],8,Tt)]))),128))]))])])):(r(),l("section",K,[e[4]||(e[4]=z('<div class="empty-icon" data-v-c77e8fe4><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" data-v-c77e8fe4><circle cx="12" cy="12" r="10" data-v-c77e8fe4></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c77e8fe4></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c77e8fe4></line></svg></div><h3 data-v-c77e8fe4>Shift Not Found</h3><p data-v-c77e8fe4>The shift you&#39;re looking for doesn&#39;t exist or has been deleted.</p>',3)),t("button",{class:"btn-primary",onClick:w}," Back to Archive ")])),M(V,{"current-route":"archive",onNavigate:d(u)},null,8,["onNavigate"])]))}}),At=E(It,[["__scopeId","data-v-c77e8fe4"]]);export{At as default};
