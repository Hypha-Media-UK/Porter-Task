import{a as $,c as O,b as a,o as n,n as m,e as t,f as d,t as i,D as w,G as g}from"./vendor-d6AZ6u8N.js";import{a as P,u as A,f as y,_ as I}from"./index-DNYSQN-_.js";const z={class:"task-content"},E={class:"task-header"},F={class:"task-category"},G={class:"task-item-type"},R={class:"location-journey"},U={class:"location from"},W={class:"location-name"},q={class:"location to"},J={class:"location-name"},K={class:"task-footer"},Q={class:"task-meta-row"},X={class:"task-times"},Y={class:"time-item"},Z={class:"time-details"},x={class:"time-value"},tt={key:0,class:"time-item"},st={class:"time-details"},et={class:"time-value completed"},ot={key:0,class:"task-porter"},it={class:"porter-details"},at={class:"porter-name"},nt={key:0,class:"task-action-ribbon"},rt={key:0,class:"shift-hours-warning"},lt={class:"task-action-buttons"},dt=$({__name:"TaskCard",props:{task:{},compact:{type:Boolean}},emits:["complete","update"],setup(_,{emit:C}){const p=_,c=P(),o=A().currentShift,k=C,b=e=>{if(!o)return!1;const s=o.type.toLowerCase(),r=c.shifts[s],j=r.end<r.start,h=new Date(e),D=h.getHours(),L=h.getMinutes(),l=D*60+L,[M,N]=r.start.split(":").map(Number),[V,H]=r.end.split(":").map(Number),v=M*60+N,f=V*60+H;return j?l>=v||l<=f:l>=v&&l<=f},T=()=>{if(!o)return"";const e=o.type.toLowerCase(),s=c.shifts[e];return`${s.start} to ${s.end}`},u=O(()=>{if(!o)return!1;const s=new Date().toISOString();return b(s)}),S=()=>{if(u.value)k("complete",p.task.id);else{const e=(o==null?void 0:o.type.toLowerCase())||"current",s=c.shifts[e];alert(`Tasks can only be completed during ${e} shift hours (${s.start} - ${s.end}). Please use the task edit form to set valid completion times.`)}},B=()=>{k("update",p.task.id)};return(e,s)=>(n(),a("article",{class:m(["task-card",{compact:e.compact,pending:e.task.status==="Pending",completed:e.task.status==="Completed"}])},[t("div",{class:m(["task-status-indicator",e.task.status.toLowerCase()])},null,2),t("div",z,[t("div",E,[t("div",F,i(e.task.jobCategory),1),t("div",G,i(e.task.itemType),1)]),t("div",R,[t("div",U,[s[0]||(s[0]=t("div",{class:"location-label"},"From:",-1)),t("div",W,i(e.task.fromLocation.displayName),1)]),s[2]||(s[2]=t("div",{class:"journey-arrow"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),t("polyline",{points:"12 5 19 12 12 19"})])],-1)),t("div",q,[s[1]||(s[1]=t("div",{class:"location-label"},"To:",-1)),t("div",J,i(e.task.toLocation.displayName),1)])]),t("div",K,[t("div",Q,[t("div",X,[t("div",Y,[s[4]||(s[4]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})],-1)),t("div",Z,[s[3]||(s[3]=t("div",{class:"time-label"},"Received:",-1)),t("div",x,i(w(y)(new Date(e.task.receivedTime))),1)])]),e.task.status==="Completed"&&e.task.completedTime?(n(),a("div",tt,[s[6]||(s[6]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),t("polyline",{points:"22 4 12 14.01 9 11.01"})],-1)),t("div",st,[s[5]||(s[5]=t("div",{class:"time-label"},"Completed:",-1)),t("div",et,i(w(y)(new Date(e.task.completedTime))),1)])])):d("",!0)]),e.task.allocatedStaff?(n(),a("div",ot,[s[8]||(s[8]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t("circle",{cx:"12",cy:"7",r:"4"})],-1)),t("div",it,[s[7]||(s[7]=t("div",{class:"porter-label"},"Assigned to:",-1)),t("div",at,i(e.task.allocatedStaff),1)])])):d("",!0)])])]),!e.compact&&e.task.status==="Pending"?(n(),a("div",nt,[u.value?d("",!0):(n(),a("div",rt," Outside shift hours ("+i(T())+") ",1)),t("div",lt,[t("button",{class:"btn-secondary update-task-btn",onClick:g(B,["stop"])}," Update "),t("button",{class:m(["btn-success mark-complete-btn",{disabled:!u.value}]),onClick:g(S,["stop"])}," Complete ",2)])])):d("",!0)],2))}}),pt=I(dt,[["__scopeId","data-v-53f98fba"]]);export{pt as T};
